# Dockerfile for CWInPy testing with Python 3.9

FROM containers.ligo.org/docker/base:conda
LABEL name="CWInPy Base miniconda3" \
maintainer="Matthew Pitkin <matthew.pitkin@ligo.org>"

RUN conda update -n base -c defaults conda

ENV conda_env python39

RUN conda create -n ${conda_env} python=3.9
RUN echo "source activate ${conda_env}" > ~/.bashrc
ENV PATH /opt/conda/envs/${conda_env}/bin:$PATH
RUN /bin/bash -c "source activate ${conda_env}"
RUN conda info
RUN python --version

# Install TeXlive
RUN apt-get update --allow-releaseinfo-change
RUN apt-get install -y --no-install-recommends libblas3 libblas-dev liblapack3 \
liblapack-dev libatlas3-base libatlas-base-dev cmake build-essential gfortran \
texlive texlive-latex-extra dvipng libgslcblas0 libgsl-dev

# Install conda-forge-installable programs
RUN conda install -n ${conda_env} -c conda-forge libstempo

